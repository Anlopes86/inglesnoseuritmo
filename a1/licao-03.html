<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>A1 - Lesson 3: My World | Inglês no seu Ritmo</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        .slide { display: none; }
        .slide.active { display: block; animation: fadeIn 0.5s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        
        /* Flashcards */
        .flashcard-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 1.5rem; }
        .flashcard { background-color: transparent; height: 200px; perspective: 1000px; cursor: pointer; }
        .flashcard-inner { position: relative; width: 100%; height: 100%; transition: transform 0.7s; transform-style: preserve-3d; }
        .flashcard.flipped .flashcard-inner { transform: rotateY(180deg); }
        .flashcard-front, .flashcard-back { position: absolute; width: 100%; height: 100%; -webkit-backface-visibility: hidden; backface-visibility: hidden; display: flex; align-items: center; justify-content: center; flex-direction: column; padding: 1.5rem; border-radius: 1rem; box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1); border: 1px solid #e5e7eb; }
        .flashcard-front { background-color: white; color: #7e22ce; text-align: center; }
        .flashcard-back { background-color: #7e22ce; color: white; transform: rotateY(180deg); text-align: center; }

        /* Drag & Drop */
        .draggable { cursor: grab; }
        .drop-zone { border-style: dashed; }
        .drop-zone.over { background-color: #f3e8ff; border-color: #7e22ce; }
        
        /* Answer Button */
        .answer-btn { background: none; border: none; cursor: pointer; color: #6b7280; margin-left: 0.5rem; }
        .answer-btn:hover { color: #4f46e5; }
        input[data-answer].correct { background-color: #f3e8ff; border-color: #7e22ce; }
        input[data-answer] { transition: all 0.3s; }

        /* Modal */
        .modal-overlay { position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0, 0, 0, 0.6); display: flex; align-items: center; justify-content: center; z-index: 50; opacity: 0; pointer-events: none; transition: opacity 0.3s ease; }
        .modal-overlay.active { opacity: 1; pointer-events: all; }
        .modal-content { background: white; padding: 2.5rem; border-radius: 1rem; max-width: 500px; width: 90%; transform: scale(0.95); transition: transform 0.3s ease; }
        .modal-overlay.active .modal-content { transform: scale(1); }
    </style>
</head>
<body class="bg-gray-50 text-gray-800">

    <header class="bg-white shadow-sm sticky top-0 z-40">
        <div class="container mx-auto px-6 py-3 flex justify-between items-center">
            <a href="a1.html" class="text-lg font-bold text-purple-600 hover:text-purple-800 flex items-center gap-2"><i class="fas fa-chevron-left"></i> Voltar para A1</a>
            <h1 class="text-xl font-semibold text-center">A1 - Lesson 3: My World</h1>
            <div class="w-24"></div>
        </div>
        <div class="w-full bg-gray-200 h-1.5"><div id="progress-bar" class="bg-purple-600 h-1.5 transition-all duration-300 ease-in-out"></div></div>
    </header>

    <main class="container mx-auto p-8 relative overflow-y-auto" style="height: calc(100vh - 140px);">
        
        <div class="slide active">
            <div class="text-center">
                <h2 class="text-4xl font-bold mb-6 text-purple-700"><i class="fas fa-comments text-yellow-500"></i> Warm-up: Who is this?</h2>
                <div class="bg-white p-8 rounded-2xl shadow-lg max-w-3xl mx-auto">
                    <p class="text-2xl mb-6 text-gray-600">Let's review!</p>
                    <div class="text-left text-xl space-y-4 bg-gray-50 p-6 rounded-lg">
                        <p><strong class="text-blue-600">Professor:</strong> "Hello! <strong class="font-bold">What is your name?</strong>" (Review)</p>
                        <p><strong class="text-orange-600">Aluno:</strong> "My name is [Student's Name]."</p>
                        <p><strong class="text-blue-600">Professor:</strong> "Nice to meet you. And <strong class="font-bold">where are you from?</strong>" (Review)</p>
                        <p><strong class="text-orange-600">Aluno:</strong> "I am from Brazil."</p>
                        <p><strong class="text-blue-600">Professor:</strong> (Shows a picture of a friend) "Great! Look. This is my friend. Her name is Maria. She is from Spain."</p>
                        <p><strong class="text-blue-600">Professor:</strong> "Today we will learn to introduce the people in our world. Your family and your friends!"</p>
                    </div>
                </div>
            </div>
        </div>

        <div class="slide">
            <div class="text-center">
                <h2 class="text-4xl font-bold mb-6 text-purple-700"><i class="fas fa-users text-purple-500"></i> Vocabulary: Family Members</h2>
                <p class="text-2xl mb-8 text-gray-600 max-w-3xl mx-auto">Click on the cards to learn the words for people in your life.</p>
                <div class="flashcard-grid max-w-6xl mx-auto">
                    <div class="flashcard" onclick="this.classList.toggle('flipped')"><div class="flashcard-inner"><div class="flashcard-front"><h3 class="text-3xl font-bold">Mother</h3></div><div class="flashcard-back"><p class="text-2xl">A female parent.</p></div></div></div>
                    <div class="flashcard" onclick="this.classList.toggle('flipped')"><div class="flashcard-inner"><div class="flashcard-front"><h3 class="text-3xl font-bold">Father</h3></div><div class="flashcard-back"><p class="text-2xl">A male parent.</p></div></div></div>
                    <div class="flashcard" onclick="this.classList.toggle('flipped')"><div class="flashcard-inner"><div class="flashcard-front"><h3 class="text-3xl font-bold">Sister</h3></div><div class="flashcard-back"><p class="text-2xl">A girl who has the same parents as you.</p></div></div></div>
                    <div class="flashcard" onclick="this.classList.toggle('flipped')"><div class="flashcard-inner"><div class="flashcard-front"><h3 class="text-3xl font-bold">Brother</h3></div><div class="flashcard-back"><p class="text-2xl">A boy who has the same parents as you.</p></div></div></div>
                    <div class="flashcard" onclick="this.classList.toggle('flipped')"><div class="flashcard-inner"><div class="flashcard-front"><h3 class="text-3xl font-bold">Friend</h3></div><div class="flashcard-back"><p class="text-2xl">A person you like and enjoy being with.</p></div></div></div>
                </div>
            </div>
        </div>
        
        <div class="slide">
             <div class="text-center">
                <h2 class="text-4xl font-bold mb-6 text-purple-700"><i class="fas fa-book-open text-green-500"></i> Grammar: My, Your, His, Her</h2>
                <div class="bg-white p-8 rounded-2xl shadow-lg max-w-4xl mx-auto text-left">
                    <p class="text-2xl mb-6 text-gray-600 text-center">We use these words to show who something belongs to.</p>
                    
                    <h3 class="font-bold text-xl text-blue-700 mb-2">My / Your (Eu / Você)</h3>
                    <div class="bg-blue-50 p-4 rounded-lg text-lg">
                        <p>This is <strong class="font-semibold">my</strong> friend. (Meu amigo)</p>
                        <p>What is <strong class="font-semibold">your</strong> name? (Seu nome)</p>
                    </div>

                    <h3 class="font-bold text-xl text-pink-700 mt-6 mb-2">His / Her (Dele / Dela)</h3>
                     <div class="bg-pink-50 p-4 rounded-lg text-lg">
                        <p>This is my brother. <strong class="font-semibold">His</strong> name is Paulo. (O nome dele)</p>
                        <p>This is my mother. <strong class="font-semibold">Her</strong> name is Ana. (O nome dela)</p>
                    </div>
                     <h3 class="font-bold text-xl text-gray-700 mt-6 mb-2">We are / They are (Nós / Eles)</h3>
                     <div class="bg-gray-100 p-4 rounded-lg text-lg">
                        <p><strong class="font-semibold">We are</strong> friends. (Nós somos amigos)</p>
                        <p><strong class="font-semibold">They are</strong> my parents. (Eles são meus pais)</p>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="slide">
            <div class="text-center">
                <h2 class="text-4xl font-bold mb-6 text-purple-700"><i class="fas fa-pencil-alt text-orange-500"></i>Practice: Introducing People</h2>
                <div class="bg-white p-8 rounded-2xl shadow-lg max-w-3xl mx-auto">
                    <p class="text-xl mb-6 text-gray-600">Complete the sentences to introduce the people.</p>
                    <div class="text-left text-xl space-y-4">
                        <p>1. This is <input data-answer="my" class="w-20 p-1 border-b-2 text-center"> sister. <input data-answer="Her" class="w-20 p-1 border-b-2 text-center"> name is Julia. <button class="answer-btn"><i class="fas fa-eye"></i></button></p>
                        <p>2. I present <input data-answer="my" class="w-20 p-1 border-b-2 text-center"> father. <input data-answer="His" class="w-20 p-1 border-b-2 text-center"> name is Roberto. <button class="answer-btn"><i class="fas fa-eye"></i></button></p>
                        <p>3. This is Maria and this is Carla. <input data-answer="They" class="w-24 p-1 border-b-2 text-center"> are friends. <button class="answer-btn"><i class="fas fa-eye"></i></button></p>
                        <p>4. What is <input data-answer="your" class="w-24 p-1 border-b-2 text-center"> mother's name? <button class="answer-btn"><i class="fas fa-eye"></i></button></p>
                        <p>5. Me and my brother. <input data-answer="We" class="w-20 p-1 border-b-2 text-center"> are a family. <button class="answer-btn"><i class="fas fa-eye"></i></button></p>
                    </div>
                </div>
            </div>
        </div>

        <div class="slide">
             <div class="text-center">
                <h2 class="text-4xl font-bold mb-6 text-purple-700"><i class="fas fa-headphones text-cyan-500"></i>Listening: My Family Photo</h2>
                <div class="bg-white p-8 rounded-2xl shadow-lg max-w-3xl mx-auto">
                    <p class="text-xl mb-6 text-gray-600">Listen to the description of a family photo and answer.</p>
                    <button id="show-script-btn" class="bg-cyan-600 text-white font-bold py-3 px-6 rounded-lg transition hover:bg-cyan-700 mb-8"><i class="fas fa-file-alt mr-2"></i> Show Teacher's Script</button>
                    <div class="text-left mt-6 text-lg space-y-6">
                        <div>
                            <label for="q1" class="font-bold block mb-2">1. Who is in the photo?</label>
                            <textarea id="q1" rows="2" class="w-full p-2 border-2 rounded-lg" placeholder="Write your answer here..."></textarea>
                        </div>
                        <div>
                            <label for="q2" class="font-bold block mb-2">2. What is his father's name?</label>
                            <textarea id="q2" rows="2" class="w-full p-2 border-2 rounded-lg" placeholder="Write your answer here..."></textarea>
                        </div>
                        <div>
                            <label for="q3" class="font-bold block mb-2">3. What is his mother's name?</label>
                            <textarea id="q3" rows="2" class="w-full p-2 border-2 rounded-lg" placeholder="Write your answer here..."></textarea>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="slide">
            <h2 class="text-4xl font-bold mb-4 text-center text-purple-700"><i class="fas fa-music text-red-500"></i> Music Time: My Life</h2>
            <div class="bg-white p-6 rounded-2xl shadow-lg max-w-4xl mx-auto">
                <iframe data-testid="embed-iframe" style="border-radius:12px" src="https://open.spotify.com/embed/track/2VCUcIPY3i6pv9Nu9Vg6k3?utm_source=generator" width="100%" height="152" frameBorder="0" allowfullscreen="" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" loading="lazy"></iframe>
                <div class="mt-6 text-center">
                    <p class="text-xl mb-4 text-gray-600">Listen to the song by Bon Jovi and complete the lyrics.</p>
                    <div class="text-xl inline-block text-left space-y-3 bg-gray-50 p-6 rounded-lg border-l-4 border-purple-500">
                         <p>This ain't a song for the broken-hearted</p>
                         <p>No silent prayer for the faith-departed</p>
                         <p>You're gonna hear <input data-answer="my" class="w-24 p-1 border-b-2 text-center bg-transparent"> voice when I shout it out loud <button class="answer-btn"><i class="fas fa-eye"></i></button></p>
                         <p>It's <input data-answer="my" class="w-24 p-1 border-b-2 text-center bg-transparent"> <input data-answer="life" class="w-24 p-1 border-b-2 text-center bg-transparent">, it's now or never <button class="answer-btn"><i class="fas fa-eye"></i></button></p>
                         <p>I ain't gonna live <input data-answer="forever" class="w-28 p-1 border-b-2 text-center bg-transparent"> <button class="answer-btn"><i class="fas fa-eye"></i></button></p>
                         <p>I just want to live while I'm alive</p>
                         <p>My heart is like an open highway</p>
                         <p>Like Frankie said, "I did it <input data-answer="my" class="w-24 p-1 border-b-2 text-center bg-transparent"> way" <button class="answer-btn"><i class="fas fa-eye"></i></button></p>
                         <p>I just wanna live while I'm alive</p>
                         <p>It's <input data-answer="my" class="w-24 p-1 border-b-2 text-center bg-transparent"> life <button class="answer-btn"><i class="fas fa-eye"></i></button></p>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="slide">
            <h2 class="text-4xl font-bold mb-6 text-center text-purple-700"><i class="fas fa-puzzle-piece text-blue-500"></i> Practice: Who is Who?</h2>
            <div class="bg-white p-8 rounded-2xl shadow-lg max-w-5xl mx-auto">
                <p class="text-xl mb-8 text-gray-600 text-center">Drag the family member to complete the sentence.</p>
                <div class="grid grid-cols-1 md:grid-cols-5 gap-6 items-center">
                    <div class="md:col-span-2 flex flex-wrap gap-4 justify-center">
                        <div id="fam-mother" class="draggable bg-pink-100 text-pink-800 p-3 rounded-lg shadow font-semibold" draggable="true">mother</div>
                        <div id="fam-father" class="draggable bg-blue-100 text-blue-800 p-3 rounded-lg shadow font-semibold" draggable="true">father</div>
                        <div id="fam-brother" class="draggable bg-green-100 text-green-800 p-3 rounded-lg shadow font-semibold" draggable="true">brother</div>
                        <div id="fam-sister" class="draggable bg-yellow-100 text-yellow-800 p-3 rounded-lg shadow font-semibold" draggable="true">sister</div>
                    </div>
                    <div class="md:col-span-3 space-y-4 text-left">
                        <div class="flex items-center gap-3"><span class="w-3/5 text-lg">Your mother's daughter is your...</span> <div data-match="fam-sister" class="drop-zone w-2/5 p-4 border-2 border-gray-300 rounded-lg min-h-[50px]"></div></div>
                        <div class="flex items-center gap-3"><span class="w-3/5 text-lg">Your father's son is your...</span> <div data-match="fam-brother" class="drop-zone w-2/5 p-4 border-2 border-gray-300 rounded-lg min-h-[50px]"></div></div>
                        <div class="flex items-center gap-3"><span class="w-3/5 text-lg">Your father's wife is your...</span> <div data-match="fam-mother" class="drop-zone w-2/5 p-4 border-2 border-gray-300 rounded-lg min-h-[50px]"></div></div>
                        <div class="flex items-center gap-3"><span class="w-3/5 text-lg">Your mother's husband is your...</span> <div data-match="fam-father" class="drop-zone w-2/5 p-4 border-2 border-gray-300 rounded-lg min-h-[50px]"></div></div>
                    </div>
                </div>
            </div>
        </div>

        <div class="slide">
             <div class="text-center">
                <h2 class="text-4xl font-bold mb-6 text-purple-700"><i class="fas fa-home text-green-500"></i>Homework: My Friend</h2>
                <div class="bg-white p-8 rounded-2xl shadow-lg max-w-2xl mx-auto">
                    <p class="text-xl mb-6 text-gray-600">Write a short paragraph to introduce one friend.</p>
                    <div class="text-left text-lg space-y-2 mt-4 bg-gray-50 p-6 rounded-lg">
                        <p class="font-bold">Use the correct possessive adjectives (my, his, her):</p>
                        <ul class="list-disc list-inside mt-2 space-y-1">
                            <li>Start with: "This is my friend."</li>
                            <li>Include their name (e.g., "His/Her name is...")</li>
                            <li>Include their nationality (e.g., "He/She is from...")</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <div class="slide">
             <div class="text-center flex flex-col items-center justify-center h-full">
                <i class="fas fa-heart text-purple-600 text-7xl mb-6"></i>
                <h2 class="text-5xl font-bold mb-4 text-gray-800">Family and friends are...</h2>
                <p class="text-3xl text-gray-600 max-w-2xl">...the two most important words in any language!</p>
            </div>
        </div>
    </main>

    <footer class="fixed bottom-0 left-0 w-full bg-white border-t z-30">
        <div class="container mx-auto px-8 h-20 flex justify-between items-center">
            <button id="prev-btn" class="bg-gray-200 text-gray-700 font-bold py-3 px-8 rounded-lg transition hover:bg-gray-300 disabled:opacity-50">Anterior</button>
            <button id="next-btn" class="bg-purple-600 text-white font-bold py-3 px-8 rounded-lg transition hover:bg-purple-700">Próximo</button>
            <button id="finish-lesson-btn" class="hidden bg-green-600 text-white font-bold py-3 px-8 rounded-lg transition hover:bg-green-700">Finalizar Aula</button>
        </div>
    </footer>

    <div id="script-modal" class="modal-overlay">
        <div class="modal-content">
            <h3 class="text-2xl font-bold mb-4 text-cyan-700">Listening Activity Script</h3>
            <p class="text-lg italic leading-relaxed">
                "Okay, look at this photo. This is my family. They are from Portugal. This is my father. His name is João. And this is my mother. Her name is Sofia. We are a happy family."
            </p>
            <button id="close-script-btn" class="mt-6 bg-gray-600 text-white font-bold py-2 px-6 rounded-lg w-full transition hover:bg-gray-700">Close</button>
        </div>
    </div>
    
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const slides = document.querySelectorAll('.slide');
            const prevBtn = document.getElementById('prev-btn');
            const nextBtn = document.getElementById('next-btn');
            const finishLessonBtn = document.getElementById('finish-lesson-btn');
            let currentSlide = 0;

            function showSlide(index) {
                slides.forEach((s, i) => s.classList.toggle('active', i === index));
                const progressBar = document.getElementById('progress-bar');
                progressBar.style.width = slides.length > 1 ? `${(index / (slides.length - 1)) * 100}%` : '100%';
                prevBtn.disabled = index === 0;
                nextBtn.classList.toggle('hidden', index === slides.length - 1);
                finishLessonBtn.classList.toggle('hidden', index !== slides.length - 1);
            }

            prevBtn.addEventListener('click', () => { if (currentSlide > 0) showSlide(--currentSlide); });
            nextBtn.addEventListener('click', () => { if (currentSlide < slides.length - 1) showSlide(++currentSlide); });
            
            // SCRIPT DE SALVAMENTO CORRIGIDO
            const firebaseConfig = {
                apiKey: "AIzaSyA4srp5nACEhOLLD8Yd4cwe5_rZ8izcm1Y",
                authDomain: "inglesnoseuritmo-bae14.firebaseapp.com",
                projectId: "inglesnoseuritmo-bae14",
                storageBucket: "inglesnoseuritmo-bae14.appspot.com",
                messagingSenderId: "112615489735",
                appId: "1:112615489735:web:9ee215ab9a2246f3a13ee2"
            };

            if (!firebase.apps.length) {
                firebase.initializeApp(firebaseConfig);
            }
            const db = firebase.firestore();

            function markLessonAsComplete() {
                const studentId = localStorage.getItem('selectedStudentId');
                if (!studentId) {
                    alert("Nenhum aluno selecionado. Por favor, selecione um aluno no painel principal.");
                    // LINK CORRIGIDO: Volta para o painel na pasta raiz
                    window.location.href = '../../index.html'; 
                    return;
                }

                const lessonId = 3; // ID desta lição
                const studentRef = db.collection("students").doc(studentId);
                const progressUpdate = {};
                progressUpdate[`progress.a1.lesson_${lessonId}`] = true;

                studentRef.update(progressUpdate)
                    .then(() => {
                        alert('Lição 3 concluída com sucesso!');
                        // LINK CORRIGIDO: Volta para a página do módulo A1 que está na mesma pasta
                        window.location.href = 'a1.html'; 
                    })
                    .catch((error) => {
                        console.error("Erro ao salvar o progresso: ", error);
                        alert("Ocorreu um erro ao salvar seu progresso. Tente novamente.");
                    });
            }

            finishLessonBtn.addEventListener('click', markLessonAsComplete);

            // Resto do seu código JS da página
            // ... (código dos botões de resposta, drag & drop, modal, etc.)

            showSlide(0);
        });
    </script>
</body>
</html>